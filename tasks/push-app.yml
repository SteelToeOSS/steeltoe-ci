---
platform: linux
image_resource:
  type: docker-image
  source:
    repository: dgodd/dotnet
inputs:
- name: cf-space
- name: publish
outputs:
- name: cf-push
run:
  path: sh
  args:
  - -exc
  - |
    ./cf-space/login
    export APPNAME=${APPNAME:-testapp}
    export SPACE=`cat cf-space/name`
    cf push $APPNAME -s $STACK -f publish/manifest.yml -p publish --hostname $APPNAME-$SPACE
    cf app $APPNAME | grep '^urls: ' | cut -d ' ' -f 2 > cf-push/url
